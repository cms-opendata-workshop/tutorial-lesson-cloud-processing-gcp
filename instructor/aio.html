<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>CMS Open Data processing in Google Cloud Platform (GCP): All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css">
<script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="manifest" href="../site.webmanifest">
<link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav incubator"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="dpoa-logo" alt="CMS DPOA logo" src="../assets/images/dpoa-logo.png"><span class="badge text-bg-danger">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='../aio.html';">Learner View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="CMS DPOA small logo" src="../assets/images/dpoa-logo-sm.png">
</div>
    <div class="lesson-title-md">
      CMS Open Data processing in Google Cloud Platform (GCP)
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            CMS Open Data processing in Google Cloud Platform (GCP)
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<hr>
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  CMS Open Data processing in Google Cloud Platform (GCP)
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../aio.html">Learner View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-intro.html">1. Introduction</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-storage.html">2. Persistent storage</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-disk-image.html">3. Disk image</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-cluster.html">4. Kubernetes cluster</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-workflow.html">5. Set up workflow</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-scaleup.html">6. Scale up</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr>
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-01-intro"><p>Content from <a href="01-intro.html">Introduction</a></p>
<hr>
<p>Last updated on 2024-10-21 |

        <a href="https://github.com/cms-opendata-workshop/tutorial-lesson-cloud-processing-gcp/edit/main/episodes/01-intro.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 15 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are public cloud provides?</li>
<li>Why would you use them?</li>
<li>What is Kubernetes?</li>
<li>What else do you need?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain the motivation for using Kubernetes cluster from public
cloud providers.</li>
<li>Explain the tools used to set up the Kubernetes cluster and run the
processing workflow.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>This tutorial shows how to set up a CMS open data processing workflow
using Kubernetes clusters from Google Cloud Platform (GCP).</p>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>To learn about CMS open data and the different data formats, work
through the tutorials in one of our <a href="https://cms-opendata-guide.web.cern.ch/cmsOpenData/workshops/" class="external-link">workshops</a>.</p>
</div>
</div>
</div>
<p>Using public cloud resources is an option for you if you do not have
enough computing resources and want to run some heavy processing. In
this tutorial, we use as an <a href="https://opendata.cern.ch/record/12504" class="external-link">example processing</a> of
CMS open data MiniAOD to a “custom” NanoAOD, including more information
than the standard NanoAOD but still in the same flat file format.</p>
<p>We assume that you would want to download the output files to your
local area and analyse them with your own resources. Note that analysis
using GCP resources with your files stored on GCP is also possible, but
is not covered in this tutorial.</p>
</section><section><h2 class="section-heading" id="google-cloud-platform">Google Cloud Platform<a class="anchor" aria-label="anchor" href="#google-cloud-platform"></a>
</h2>
<hr class="half-width">
<p>Public cloud providers are companies that offers computing resources
and services over the internet to multiple users or organizations.
Google Cloud Platform (GCP) is one of them. You define and deploy the
resources that you need and pay for what you use. As many other such
resource providers (for example AWS, Azure, OHV), it offers some free
getting-started “credits”.</p>
<div id="callout2" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>GCP offers <a href="https://cloud.google.com/free/docs/free-cloud-features#free-trial" class="external-link">free
trial</a> credits for $300 for a new account. This credit is valid for
90 days.</p>
<p>This tutorial was set up using <a href="https://cloud.google.com/edu/researchers" class="external-link">Google Cloud Research
credits</a>. You can apply for similar credits for your research
projects. Take note that the credit has to be used within 12 months.</p>
</div>
</div>
</div>
<p>You can create, manage and delete resources using the Google Cloud
Console (a Web UI) or a command-line tool <code>gcloud</code>.</p>
<p>In this tutorial, we use <code>gcloud</code> commands to create the
persistent storage for the output data, and a Terraform script to
provision the Kubernetes cluster where the processing workflow will
run.</p>
</section><section><h2 class="section-heading" id="terraform">Terraform<a class="anchor" aria-label="anchor" href="#terraform"></a>
</h2>
<hr class="half-width">
<p><a href="https://www.terraform.io/" class="external-link">Terraform</a> is a tool to
define, provision, and manage cloud infrastructure using configuration
scripts.</p>
<p>In this tutorial, we use Terraform scripts to create the Kubernetes
cluster in a single step. The advantage - compared to plain command-line
<code>gcloud</code> commands - is that we can easily configure input
variables. Also, after the workflow finishes, it is easy to delete the
resources in a single step.</p>
</section><section><h2 class="section-heading" id="kubernetes">Kubernetes<a class="anchor" aria-label="anchor" href="#kubernetes"></a>
</h2>
<hr class="half-width">
<p>Kubernetes is a system to managed containerized workflows on
computing clusters. <code>kubectl</code> is the command-line tool to
interact with the cluster resources.</p>
<p>In this tutorial, we use <code>kubectl</code> commands to set up some
services and to observe the status of the cluster and the data
processing workflow.</p>
</section><section><h2 class="section-heading" id="argo-workflows">Argo Workflows<a class="anchor" aria-label="anchor" href="#argo-workflows"></a>
</h2>
<hr class="half-width">
<p>The processing workflow consist of some sequential and parallel
steps. We use <a href="https://argoproj.github.io/workflows/" class="external-link">Argo
Workflows</a> to define (or “orchestrate”) the workflow steps.</p>
<p>In this tutorial, the Argo Workflows services are set up using a
<code>kubectl</code> command. We use <code>argo</code>, the command-line
tool, to submit and manage the workflows.</p>
</section><section><h2 class="section-heading" id="ready-to-go">Ready to go?<a class="anchor" aria-label="anchor" href="#ready-to-go"></a>
</h2>
<hr class="half-width">
<div id="checklist1" class="callout checklist">
<div class="callout-square">
<i class="callout-icon" data-feather="check-square"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Checklist</h3>
<div class="callout-content">
<p>Check the instructions in <a href="index.html#software-setup">Software setup</a></p>
<ul class="task-list">
<li><label><input type="checkbox">a GCP account and a GCP
project</label></li>
<li><label><input type="checkbox">Linux shell available (Linux, macOS
or WSL2 on Windows)</label></li>
<li><label><input type="checkbox">gcloud installed</label></li>
<li><label><input type="checkbox">kubectl installed</label></li>
<li><label><input type="checkbox">Terraform installed</label></li>
<li><label><input type="checkbox">go installed</label></li>
<li><label><input type="checkbox">Argo CLI installed</label></li>
</ul>
<p>When done, let’s go!</p>
</div>
</div>
</div>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">
  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>
  Too much to install? I just want a quick try…
  </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler1" aria-labelledby="headingSpoiler1">
<div class="accordion-body">
<p>If you don’t have access to a Linux terminal or prefer not to install
tools locally, you can use Google Cloud Shell. You’ll need a Google
Cloud Platform (GCP) account and a GCP project. To open Cloud Shell,
click the Cloud Shell icon in the top-right corner of the Google Cloud
Console.</p>
<p>Cloud Shell comes pre-installed with gcloud, kubectl, terraform, and
go. However, you’ll need to install the Argo CLI manually.</p>
<p>Remember that while using Cloud Shell is free, you will need to have
credits (or pay) for the resources you deploy.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Public cloud providers are companies that offer pay-as-you-go
computing resources and services over the internet to multiple users or
organizations.</li>
<li>Terraform is an open-source tool to provision and delete computing
infrastructure.</li>
<li>Kubernetes is an open-source system for automating deployment,
scaling, and management of containerized applications and their
associated workflows across clusters of hosts..</li>
<li>Argo Workflows is an open-source tool for orchestrating sequential
and parallel jobs on Kubernetes.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-02-storage"><p>Content from <a href="02-storage.html">Persistent storage</a></p>
<hr>
<p>Last updated on 2024-10-21 |

        <a href="https://github.com/cms-opendata-workshop/tutorial-lesson-cloud-processing-gcp/edit/main/episodes/02-storage.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 15 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How to create a Google Cloud Storage bucket?</li>
<li>What are the basic operations?</li>
<li>What are the cost of storage and download?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learn to create a Google Cloud Storage bucket</li>
<li>Learn to list the contents of a bukcet</li>
<li>Understand the persistant storage costs.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="storage-for-the-output-files">Storage for the output files<a class="anchor" aria-label="anchor" href="#storage-for-the-output-files"></a>
</h2>
<hr class="half-width">
<p>The processing workflow writes the output files to a storage from
which they can be downloaded afterwards.</p>
<p>For this tutorial, we use a <a href="https://cloud.google.com/storage/docs/buckets" class="external-link">Google Cloud
Storage (GCS) bucket</a>.</p>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>The storage is created separately from the cluster resources. You can
then delete the cluster just after the processing and avoid unnecessary
costs, but keep the output files.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="gcp-account-and-project">GCP account and project<a class="anchor" aria-label="anchor" href="#gcp-account-and-project"></a>
</h3>
<p>Make sure that you are in the GCP account and project that you intend
to use for this work. In your Linux terminal, type</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">gcloud</span> config list</span></code></pre>
</div>
<p>The output shows your account and project.</p>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">
  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>
  How to change them?
  </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" aria-labelledby="headingSpoiler1" data-bs-parent="#accordionSpoiler1">
<div class="accordion-body">
<p>If they are not what you expect (in case you have many), change them
with</p>
<pre class="bask"><code>gcloud config set account &lt;ACCOUNT&gt;</code></pre>
<p>and</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">gcloud</span> config set project <span class="op">&lt;</span>PROJECT_ID<span class="op">&gt;</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="accounts">Accounts<a class="anchor" aria-label="anchor" href="#accounts"></a>
</h4>
<p>You can can check the credentialed accounts with</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">gcloud</span> auth list</span></code></pre>
</div>
<p>If you get none or your account does not appear in the list, run</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">gcloud</span> init</span></code></pre>
</div>
<p>and follow the steps in the output.</p>
</div>
<div class="section level4">
<h4 id="projects">Projects<a class="anchor" aria-label="anchor" href="#projects"></a>
</h4>
<p>List the projects within the active account with</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">gcloud</span> projects list</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="billing-account">Billing account?<a class="anchor" aria-label="anchor" href="#billing-account"></a>
</h3>
<p>If this is your first project or you created it from the Google Cloud
Console Web UI, it will have a billing account linked to it, and you are
ready to go.</p>
<p>If you created the project from the command line without specifying
the billing account, you must link it to an existing billing
account.</p>
<div id="accordionSpoiler2" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler2" aria-expanded="false" aria-controls="collapseSpoiler2">
  <h3 class="accordion-header" id="headingSpoiler2">
  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>
  How to link a project to your billing account?
  </h3>
</button>
<div id="collapseSpoiler2" class="accordion-collapse collapse" aria-labelledby="headingSpoiler2" data-bs-parent="#accordionSpoiler2">
<div class="accordion-body">
<p>First list the billing accounts</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">gcloud</span> billing accounts list</span></code></pre>
</div>
<p>Take the account id from the output, and check if your project is
linked to it</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">gcloud</span> billing projects list <span class="at">--billing-account</span> <span class="op">&lt;</span>ACCOUNT_ID<span class="op">&gt;</span></span></code></pre>
</div>
<p>If not, link your project to this account with</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">gcloud</span> billing projects link <span class="op">&lt;</span>PROJECT_ID<span class="op">&gt;</span> --billing-account <span class="op">&lt;</span>ACCOUNT_ID<span class="op">&gt;</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="choose-your-region">Choose your region<a class="anchor" aria-label="anchor" href="#choose-your-region"></a>
</h3>
<p>In this tutorial, we will use the Google computing centre
<code>europe-west4</code> located in Netherlands. You can use another
one, but use it consistently.</p>
<p>If you computing resources are in a different region than your
storage, additional costs and delay may occur.</p>
</div>
</section><section><h2 class="section-heading" id="create-the-bucket">Create the bucket<a class="anchor" aria-label="anchor" href="#create-the-bucket"></a>
</h2>
<hr class="half-width">
<p>Create a storage bucket with</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="ex">gcloud</span> storage buckets create gs://<span class="op">&lt;</span>BUCKET_NAME<span class="op">&gt;</span> --location europe-west4</span></code></pre>
</div>
<p>You can test copying a file to it with</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="bu">echo</span> test <span class="op">&gt;</span> test.txt</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="ex">gcloud</span> storage cp test.txt gs://<span class="op">&lt;</span>BUCKET_NAME<span class="op">&gt;</span>/</span></code></pre>
</div>
<p>and list the contents of the bucket with</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="ex">gcloud</span> storage ls gs://<span class="op">&lt;</span>BUCKET_NAME<span class="op">&gt;</span>/<span class="pp">*</span></span></code></pre>
</div>
<p>You can remove the file with</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="ex">gcloud</span> storage rm gs://<span class="op">&lt;</span>BUCKET_NAME<span class="op">&gt;</span>/test.txt</span></code></pre>
</div>
<p>Note that the bucket is tied to your GCP project and you can only
access it when authenticated.</p>
</section><section><h2 class="section-heading" id="costs">Costs<a class="anchor" aria-label="anchor" href="#costs"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="storage">Storage<a class="anchor" aria-label="anchor" href="#storage"></a>
</h3>
<p>The <a href="https://cloud.google.com/storage/pricing" class="external-link">storage
cost</a> of a GCS bucket depends on the data volume. The costs may vary
from a region to another. For <code>europe-west4</code>, the current
(October 2024) monthly cost is $0.020 / GB.</p>
</div>
<div class="section level3">
<h3 id="operations">Operations<a class="anchor" aria-label="anchor" href="#operations"></a>
</h3>
<p>An <a href="https://cloud.google.com/storage/pricing#operations-pricing" class="external-link">operation</a>
is an action that makes changes to or retrieves information from a
bucket and it has a tiny cost: $0.005 per 1000 operations. This applies,
for example, to listing the contents of the bucket on your terminal. The
traffic between GCP computing resources and storage within the same
region (e.g. in <code>europe-west4</code>) is free.</p>
<p>In the context of this tutorial, the operations costs are
insignificant. However, keep this is mind if you plan to write scripts
that list the bucket content from your terminal.</p>
</div>
<div class="section level3">
<h3 id="networking-and-download">Networking and download<a class="anchor" aria-label="anchor" href="#networking-and-download"></a>
</h3>
<p><a href="https://cloud.google.com/storage/pricing#network-egress" class="external-link">Downloading
data</a> from the GCS bucket to your computer has a significant cost:
the current (October 2024) cost to internet locations (excluding China
and Austalia) is $0.12 / GB.</p>
<p>In the context of the example of this tutorial, the resulting output
files are approximately 30% of the original MiniAOD dataset volume. For
example, downloading the 330 GB ouput from a processing of a 1.1 TB
MiniAOD dataset will cost $40.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Google Cloud Storage bucket can be used to store the output
files.</li>
<li>The storage cost depends on the volume stored and for this type of
processing is very small.</li>
<li>The download of big output files from the bucket can be costly.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-03-disk-image"><p>Content from <a href="03-disk-image.html">Disk image</a></p>
<hr>
<p>Last updated on 2024-10-21 |

        <a href="https://github.com/cms-opendata-workshop/tutorial-lesson-cloud-processing-gcp/edit/main/episodes/03-disk-image.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 15 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Why to build a disk image for cluster nodes?</li>
<li>How to build a disk image?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Create a disk image with the container images.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="why-a-disk-image">Why a disk image?<a class="anchor" aria-label="anchor" href="#why-a-disk-image"></a>
</h2>
<hr class="half-width">
<p>The container image for the MiniAOD processing is very big and it
needs to be pulled to the nodes of the cluster. It can take 30 mins to
pull it. Making it available to the nodes of the cluster through a
pre-built secondary disk image speeds up the workflow start.</p>
<p>We will follow the <a href="https://cloud.google.com/kubernetes-engine/docs/how-to/data-container-image-preloading#prepare" class="external-link">instructions</a>
provided by GCP to build the secondary disk image. All necessary steps
are provided in this lesson.</p>
</section><section><h2 class="section-heading" id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="gcp-account-and-project">GCP account and project<a class="anchor" aria-label="anchor" href="#gcp-account-and-project"></a>
</h3>
<p>Make sure that you are in the GCP account and project that you intend
to use for this work. In your Linux terminal, type</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">gcloud</span> config list</span></code></pre>
</div>
<p>The output shows your account and project.</p>
</div>
<div class="section level3">
<h3 id="bucket-for-logs">Bucket for logs<a class="anchor" aria-label="anchor" href="#bucket-for-logs"></a>
</h3>
<p>To build an image disk, we will use a script that produces some logs.
Create a bucket for these logs with</p>
<pre><code>gcloud storage buckets create gs://&lt;BUCKET_FOR_LOGS&gt;/ --location europe-west4</code></pre>
</div>
<div class="section level3">
<h3 id="go-installed">Go installed?<a class="anchor" aria-label="anchor" href="#go-installed"></a>
</h3>
<p>You should have <code>go</code> installed, see <a href="index.html#software-setup">Software setup</a>.</p>
</div>
<div class="section level3">
<h3 id="enabling-services">Enabling services<a class="anchor" aria-label="anchor" href="#enabling-services"></a>
</h3>
<p>Before you can create resources on GCP, you will need to enable the
corresponding services.</p>
<p>Your project usually has several services enabled already. You can
list them with</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">gcloud</span> services list <span class="at">--enabled</span></span></code></pre>
</div>
<p>You can list all available services with</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">gcloud</span> services list <span class="at">--available</span></span></code></pre>
</div>
<p>but that’s a long list!</p>
<p>To build a disk image, you will need to <a href="https://cloud.google.com/endpoints/docs/openapi/enable-api#enabling_an_api" class="external-link">enable</a>
Cloud Build API (cloudbuild.googleapis.com) and Compute Engine API
(compute.googleapis.com) with</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">gcloud</span> services enable cloudbuild.googleapis.com compute.googleapis.com</span></code></pre>
</div>
<p>When services are enabled, some “service accounts” with specific
roles get created. You can list them with</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">gcloud</span> projects get-iam-policy <span class="op">&lt;</span>PROJECT_ID<span class="op">&gt;</span></span></code></pre>
</div>
<p>Often, the resources need to work with each other. In this case, the
Cloud Build service needs to have two additional roles to access Compute
resources (the image disk belongs to that category).</p>
<p>Add them with</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">gcloud</span> projects add-iam-policy-binding <span class="op">&lt;</span>PROJECT_ID<span class="op">&gt;</span> --member serviceAccount:<span class="op">&lt;</span>PROJECT_NR<span class="op">&gt;</span>@cloudbuild.gserviceaccount.com <span class="at">--role</span> roles/compute.serviceAgent</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">gcloud</span> projects add-iam-policy-binding <span class="op">&lt;</span>PROJECT_ID<span class="op">&gt;</span> --member serviceAccount:<span class="op">&lt;</span>PROJECT_NR<span class="op">&gt;</span>@cloudbuild.gserviceaccount.com <span class="at">--role</span> roles/compute.admin</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="application-login">Application login<a class="anchor" aria-label="anchor" href="#application-login"></a>
</h3>
<p>You need to create a credential file to run the script:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">gcloud</span> auth application-default login</span></code></pre>
</div>
<p>and authenticate in the browser window that opens.</p>
</div>
</section><section><h2 class="section-heading" id="get-the-code">Get the code<a class="anchor" aria-label="anchor" href="#get-the-code"></a>
</h2>
<hr class="half-width">
<p>Pull the code from <a href="https://github.com/GoogleCloudPlatform/ai-on-gke/tree/main/tools/gke-disk-image-builder" class="external-link uri">https://github.com/GoogleCloudPlatform/ai-on-gke/tree/main/tools/gke-disk-image-builder</a></p>
<p>If you want only this directory and not the full repository, use the
sparse checkout:</p>
<pre><code>git init &lt;your_new_folder&gt;
cd &lt;your_new_folder&gt;
git remote add -f origin git@github.com:GoogleCloudPlatform/ai-on-gke.git</code></pre>
<p>This takes a while.</p>
<pre><code>git config core.sparseCheckout true
echo "tools/gke-disk-image-builder/" &gt;&gt;  .git/info/sparse-checkout
git pull origin main
cd tools/gke-disk-image-builder/</code></pre>
</section><section><h2 class="section-heading" id="create-the-image">Create the image<a class="anchor" aria-label="anchor" href="#create-the-image"></a>
</h2>
<hr class="half-width">
<p>To run the script to build the image, you must have <code>go</code>
installed.</p>
<p>Run the script with</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="ex">go</span> run ./cli <span class="at">--project-name</span><span class="op">=&lt;</span>PROJECT_ID<span class="op">&gt;</span> --image-name=pfnano-disk-image <span class="at">--zone</span><span class="op">=</span>europe-west4-a <span class="at">--gcs-path</span><span class="op">=</span>gs://<span class="op">&lt;</span>BUCKET_FOR_LOGS<span class="op">&gt;</span> --disk-size-gb=50 <span class="at">--container-image</span><span class="op">=</span>docker.io/cernopendata/cernopendata-client:latest <span class="at">--container-image</span><span class="op">=</span>docker.io/rootproject/root:latest  <span class="at">--container-image</span><span class="op">=</span>ghcr.io/cms-dpoa/pfnano-image-build:main <span class="at">--timeout</span> 100m</span></code></pre>
</div>
<p>The script will create a secondary disk images with the container
images that are needed in the processing workflow:</p>
<ul>
<li>
<code>cernopendata/cernopendata-client</code> for getting the
metadata</li>
<li>
<code>ghcr.io/cms-dpoa/pfnano-image-build:main</code> for the
processing</li>
<li>
<code>rootproject/root</code> for an eventual test plot.</li>
</ul>
<p>The container image <code>pfnano-image-build</code> is the standard
<a href="https://opendata.cern.ch/docs/cms-guide-docker#images" class="external-link">CMS Open
data container image</a> with the <a href="https://opendata.cern.ch/record/12504" class="external-link">PFNano processing code</a>
compiled.</p>
<p>Note the <code>timeout</code> options, the default tiemout of 20 mins
is not enough.</p>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout</h3>
<div class="callout-content">
<p>Note that while images can in most cases be “pulled” from Dockerhub
specifying only the image name
(e.g. <code>cernopendata/cernopendata-client</code> and
<code>rootproject/root</code>), in this script you must give the full
registry address starting with <code>docker.io</code>
<strong>and</strong> specify a tag (i.e. <code>:latest</code>).</p>
</div>
</div>
</div>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">
  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>
  Error: Quota exceeded?
  </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" aria-labelledby="headingSpoiler1" data-bs-parent="#accordionSpoiler1">
<div class="accordion-body">
<p>Failure with errors of type</p>
<pre><code>Code: QUOTA_EXCEEDED
Message: Quota 'N2_CPUS' exceeded.</code></pre>
<p>are due to requested machine type no being available in the requested
zone. Nothing to do with you quota.</p>
<p>Try in a different region or with a different machine type. You can
give them as parameters
e.g. <code>--zone=europe-west4-a --machine-type=e2-standard-4</code>.
Independent of the zone specified in parameters, the disk image will
have <code>eu</code> as the location, so any zone in <code>europe</code>
is OK (if you plan to create your cluster in a zone in
<code>europe</code>).</p>
<p>Note that the bucket for logs has to be in the same region so you
might need to create another one. Remove the old one with
<code>gcloud storage rm -r gs://&lt;BUCKET_FOR_LOGS&gt;</code>.</p>
</div>
</div>
</div>
</div>
<p>Once the image is built, you can see it in the list of available
images with</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="ex">gcloud</span> compute images list</span></code></pre>
</div>
<p>That’s a long list, there are many images already available. Your new
image has your project name under “PROJECT” and
<code>secondary-disk-image</code> under “FAMILY”.</p>
</section><section><h2 class="section-heading" id="costs">Costs<a class="anchor" aria-label="anchor" href="#costs"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="computing">Computing<a class="anchor" aria-label="anchor" href="#computing"></a>
</h3>
<p>The script runs a Google Cloud Build process and there’s per-minute
small <a href="https://cloud.google.com/build/pricing" class="external-link">cost</a>. 120
minutes are included in the <a href="https://cloud.google.com/free/docs/free-cloud-features#free-tier-usage-limits" class="external-link">Free
tier services</a>.</p>
</div>
<div class="section level3">
<h3 id="storage">Storage<a class="anchor" aria-label="anchor" href="#storage"></a>
</h3>
<p>The image is stored in Google Compute Engine image storage, and the
cost is computed by the archive size of the image. The cost is very low:
in our example case, the size is 12.25 GB, and the monthly cost is
$0.05/GB.</p>
<p>There’s a minimal cost for the output logs GCS bucket. The bucket can
be deleted after the build.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>A secondary boot disk with the container image preloaded can speed
up the workflow start.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-04-cluster"><p>Content from <a href="04-cluster.html">Kubernetes cluster</a></p>
<hr>
<p>Last updated on 2024-10-21 |

        <a href="https://github.com/cms-opendata-workshop/tutorial-lesson-cloud-processing-gcp/edit/main/episodes/04-cluster.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 15 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How to create a Google Kubernetes Engine cluster?</li>
<li>How to access the cluster from the command line?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learn to create a Google Kubernetes Engine cluster.</li>
<li>Access the cluster and inspect it from the command line.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="gcp-account-and-project">GCP account and project<a class="anchor" aria-label="anchor" href="#gcp-account-and-project"></a>
</h3>
<p>Make sure that you are in the GCP account and project that you intend
to use for this work. In your Linux terminal, type</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">gcloud</span> config list</span></code></pre>
</div>
<p>The output shows your account and project.</p>
</div>
<div class="section level3">
<h3 id="enabling-services">Enabling services<a class="anchor" aria-label="anchor" href="#enabling-services"></a>
</h3>
<p>Before you can create resources on GCP, you will need to enable
them</p>
<p>In addition to what was enabled in the previous section, we will now
enable Kubernetes Engine API (container.googleapis.com):</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">gcloud</span> services enable container.googleapis.com</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="bucket">Bucket<a class="anchor" aria-label="anchor" href="#bucket"></a>
</h3>
<p>If you worked through Section 02, you have now a storage bucket for
the output files.</p>
<p>List the buckets with</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">gcloud</span> storage ls</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="secondary-disk">Secondary disk<a class="anchor" aria-label="anchor" href="#secondary-disk"></a>
</h3>
<p>If you worked through Section 03, you have a secondary boot disk
image available</p>
</div>
</section><section><h2 class="section-heading" id="get-the-code">Get the code<a class="anchor" aria-label="anchor" href="#get-the-code"></a>
</h2>
<hr class="half-width">
<p>The example Terraform scripts and Argo Workflow configuration are in
<a href="https://github.com/cms-dpoa/cloud-processing/tree/main/standard-gke-cluster-gcs-imgdisk" class="external-link uri">https://github.com/cms-dpoa/cloud-processing/tree/main/standard-gke-cluster-gcs-imgdisk</a></p>
<p>Get them with</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">git</span> clone git@github.com:cms-dpoa/cloud-processing.git</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="bu">cd</span> cloud-processing/standard-gke-cluster-gcs-imgdisk</span></code></pre>
</div>
</section><section><h2 class="section-heading" id="about-terraform">About Terraform<a class="anchor" aria-label="anchor" href="#about-terraform"></a>
</h2>
<hr class="half-width">
<p>The resources are created by <a href="https://developer.hashicorp.com/terraform?product_intent=terraform" class="external-link">Terraform</a>
scripts (with the file extension <code>.tf</code>) in the working
directory.</p>
<p>In the example case, they are very simple and the same could be
easily done with <code>gcloud</code> commands.</p>
<p>Terraform, however, makes it easy to change and keep track of the
parameters. Read more about Terraform on Google Cloud in the <a href="https://cloud.google.com/docs/terraform/terraform-overview" class="external-link">Terraform
overview</a>.</p>
<p>The configurable parameters are defined in <code>variables.tf</code>
and can be modified in <code>terraform.tfvars</code>.</p>
</section><section><h2 class="section-heading" id="create-the-cluster">Create the cluster<a class="anchor" aria-label="anchor" href="#create-the-cluster"></a>
</h2>
<hr class="half-width">
<p>Set the variables in the <code>terraform.tfvars</code> file for
example to</p>
<pre><code><span><span class="va">project_id</span>          <span class="op">=</span> <span class="st">"&lt;PROJECT_ID&gt;"</span></span>
<span><span class="va">region</span>              <span class="op">=</span> <span class="st">"europe-west4-a"</span></span>
<span><span class="va">name</span>                <span class="op">=</span> <span class="st">"1"</span></span>
<span><span class="va">gke_num_nodes</span>       <span class="op">=</span> <span class="fl">2</span></span></code></pre>
<p>With these parameters, a cluster named <code>cluster-1</code> with 2
nodes will be created in the region <code>europe-west4-a</code>. You
must define your GCP project.</p>
<p>To create the resources, run</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">terraform</span> apply</span></code></pre>
</div>
<p>and confirm “yes”.</p>
</section><section><h2 class="section-heading" id="connect-to-the-cluster-and-inspect">Connect to the cluster and inspect<a class="anchor" aria-label="anchor" href="#connect-to-the-cluster-and-inspect"></a>
</h2>
<hr class="half-width">
<p>Once the cluster is created - it will take a while - connect to it
with</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">gcloud</span> container clusters get-credentials <span class="op">&lt;</span>CLUSTER_NAME<span class="op">&gt;</span> --region europe-west4-a <span class="at">--project</span> <span class="op">&lt;</span>PROJECT_ID<span class="op">&gt;</span></span></code></pre>
</div>
<p>You can inspect the cluster with <code>kubectl</code> commands, for
example the nodes:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">kubectl</span> get nodes</span></code></pre>
</div>
<p>and the namespaces:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">kubectl</span> get ns</span></code></pre>
</div>
<p>You will see several namespaces, and most of them are used by
Kubernetes for different services. We will be using the
<code>argo</code> namespace.</p>
<p>For more information about <code>kubectl</code>, check the <a href="https://kubernetes.io/docs/reference/kubectl/quick-reference/" class="external-link">Quick
Reference</a> and the links therein, or use the <code>--help</code>
option with any of the <code>kubectl</code> commands.</p>
<!-- ## Enable image streaming

This is finally not needed. The streaming for the secondary disk works even if Image streaming shows Disabled in the cluster features

```bash
 gcloud container clusters update <CLUSTER_NAME> --zone europe-west4-a --enable-image-streaming

``` -->
</section><section><h2 class="section-heading" id="costs">Costs<a class="anchor" aria-label="anchor" href="#costs"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="cluster-management-fee">Cluster management fee<a class="anchor" aria-label="anchor" href="#cluster-management-fee"></a>
</h3>
<p>For the GKE “Standard” cluster, there’s a cluster management fee of
$0.10 per hour.</p>
</div>
<div class="section level3">
<h3 id="cpu-and-memory">CPU and memory<a class="anchor" aria-label="anchor" href="#cpu-and-memory"></a>
</h3>
<p>The cost is determined by the machine and disk type and is per time.
For this small example cluster with two e2-standard-4 nodes (4 vCPUs and
16 GB memory) the cost the cost is 0.3$ per hour. Each node has a 100 GB
disk, and the cost is for two of these disks is 0.006$ per hour,
i.e. very small compared to the machine cost.</p>
<p>The cluster usage contributes to the cost through data transfer and
networking, but for this example case it is minimal.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Kubernetes clusters can be created with Terraform scripts.</li>
<li>
<code>kubectl</code> is the tool to interact with the cluster.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-05-workflow"><p>Content from <a href="05-workflow.html">Set up workflow</a></p>
<hr>
<p>Last updated on 2024-10-21 |

        <a href="https://github.com/cms-opendata-workshop/tutorial-lesson-cloud-processing-gcp/edit/main/episodes/05-workflow.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 15 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How to set up Argo Workflow engine?</li>
<li>How to submit a test job?</li>
<li>Where to find the output?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Deploy Argo Workflows services to the cluster.</li>
<li>Submit a test job.</li>
<li>Find the output in your bucket.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="prerequisites">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="gcp-account-and-project">GCP account and project<a class="anchor" aria-label="anchor" href="#gcp-account-and-project"></a>
</h3>
<p>Make sure that you are in the GCP account and project that you intend
to use for this work. In your Linux terminal, type</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">gcloud</span> config list</span></code></pre>
</div>
<p>The output shows your account and project.</p>
</div>
<div class="section level3">
<h3 id="bucket">Bucket<a class="anchor" aria-label="anchor" href="#bucket"></a>
</h3>
<p>If you worked through <a href="02-storage">Section 02</a>, you have
now a storage bucket for the output files.</p>
<p>List the buckets with</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">gcloud</span> storage ls</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="code">Code<a class="anchor" aria-label="anchor" href="#code"></a>
</h3>
<p>In the <a href="04-cluster">previous section</a>, you pulled the code
and move to the
<code>cloud-processing/standard-gke-cluster-gcs-imgdisk</code>
directory.</p>
</div>
<div class="section level3">
<h3 id="argo-cli-installed">Argo CLI installed?<a class="anchor" aria-label="anchor" href="#argo-cli-installed"></a>
</h3>
<p>You should have Argo CLI installed, see <a href="index.html#software-setup">Software setup</a>.</p>
</div>
</section><section><h2 class="section-heading" id="deploy-argo-workflows-service">Deploy Argo Workflows service<a class="anchor" aria-label="anchor" href="#deploy-argo-workflows-service"></a>
</h2>
<hr class="half-width">
<p>Deploy Argo Workflows services with</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-n</span> argo  <span class="at">-f</span> https://github.com/argoproj/argo-workflows/releases/download/v3.5.10/install.yaml</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> argo/service_account.yaml</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> argo/argo_role.yaml</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="ex">kubectl</span> apply <span class="at">-f</span> argo/argo_role_binding.yaml</span></code></pre>
</div>
<p>Wait for the services to start.</p>
<p>You should see the following:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">$</span> kubectl get all <span class="at">-n</span> argo</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="ex">NAME</span>                                       READY   STATUS    RESTARTS   AGE</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="ex">pod/argo-server-5f7b589d6f-jkf4z</span>           1/1     Running   0          24s</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="ex">pod/workflow-controller-864c88655d-wsfr8</span>   1/1     Running   0          24s</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="ex">NAME</span>                  TYPE        CLUSTER-IP      EXTERNAL-IP   PORT<span class="er">(</span><span class="ex">S</span><span class="kw">)</span>    <span class="ex">AGE</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="ex">service/argo-server</span>   ClusterIP   34.118.233.69   <span class="op">&lt;</span>none<span class="op">&gt;</span>        2746/TCP   25s</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="ex">NAME</span>                                  READY   UP-TO-DATE   AVAILABLE   AGE</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="ex">deployment.apps/argo-server</span>           1/1     1            1           24s</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="ex">deployment.apps/workflow-controller</span>   1/1     1            1           24s</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="ex">NAME</span>                                             DESIRED   CURRENT   READY   AGE</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="ex">replicaset.apps/argo-server-5f7b589d6f</span>           1         1         1       24s</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="ex">replicaset.apps/workflow-controller-864c88655d</span>   1         1         1       24s</span></code></pre>
</div>
</section><section><h2 class="section-heading" id="about-argo-workflows">About Argo Workflows<a class="anchor" aria-label="anchor" href="#about-argo-workflows"></a>
</h2>
<hr class="half-width">
<p>The data processing example is defined as an Argo workflow. You can
learn about Argo Workflows in their <a href="https://argo-workflows.readthedocs.io/en/latest/" class="external-link">documentation</a>.</p>
<p>Every step in the workflow runs in a container, and there several
ways to pass the information between the steps.</p>
<p>The example configuration in <code>argo/argo_bucket_run.yaml</code>
has comments to help you to understand how the files and/or parameters
can be passed from a step to another.</p>
</section><section><h2 class="section-heading" id="submit-a-test-job">Submit a test job<a class="anchor" aria-label="anchor" href="#submit-a-test-job"></a>
</h2>
<hr class="half-width">
<p>The workflow is defined in the <code>argo/argo_bucket_run.yaml</code>
file. It is composed of four steps:</p>
<ul>
<li>
<code>get-metadata</code>: gets the number of files and the file
list for a given CMS Open Data 2016 MiniAOD record</li>
<li>
<code>joblist</code>: divides the file list into given number of
jobs and coumputes the number of events per job (if not all)</li>
<li>
<code>runpfnano</code>: runs the processing in parallel jobs</li>
<li>
<code>plot</code>: creates some simple plots.</li>
</ul>
<p>Edit the parameters in the <code>argo/argo_bucket_run.yaml</code> so
that they are</p>
<pre><code>    parameters:
    - name: nEvents
      # Number of events in the dataset to be processed (-1 is all)
      value: 1000
    - name: recid
      # Record id of the dataset to be processed
      value: 30511
    - name: nJobs
      # Number of jobs the processing workflow should be split into
      value: 2
    - name: bucket
      # Name of cloud storage bucket for storing outputs
      value: &lt;YOUR_BUCKET_NAME&gt;</code></pre>
<p>Now submit the workflow with</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">argo</span> submit <span class="at">-n</span> argo argo/argo_bucket_run.yaml</span></code></pre>
</div>
<p>Observe its progress with</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">argo</span> get <span class="at">-n</span> argo @latest</span></code></pre>
</div>
<p>Once done, check the ouput in the bucket with</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">$</span> gcloud storage ls gs://<span class="op">&lt;</span>YOUR_BUCKET_NAME<span class="op">&gt;</span>/<span class="pp">**</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="ex">gs://</span><span class="op">&lt;</span>YOUR_BUCKET_NAME<span class="op">&gt;</span>/pfnano/30511/files_30511.txt</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="ex">gs://</span><span class="op">&lt;</span>YOUR_BUCKET_NAME<span class="op">&gt;</span>/pfnano/30511/logs/1.logs</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="ex">gs://</span><span class="op">&lt;</span>YOUR_BUCKET_NAME<span class="op">&gt;</span>/pfnano/30511/logs/2.logs</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="ex">gs://</span><span class="op">&lt;</span>YOUR_BUCKET_NAME<span class="op">&gt;</span>/pfnano/30511/plots/h_num_cands.png</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="ex">gs://</span><span class="op">&lt;</span>YOUR_BUCKET_NAME<span class="op">&gt;</span>/pfnano/30511/plots/h_pdgid_cands.png</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="ex">gs://</span><span class="op">&lt;</span>YOUR_BUCKET_NAME<span class="op">&gt;</span>/pfnano/30511/scatter/pfnanooutput1.root</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="ex">gs://</span><span class="op">&lt;</span>YOUR_BUCKET_NAME<span class="op">&gt;</span>/pfnano/30511/scatter/pfnanooutput2.root</span></code></pre>
</div>
<p>You can copy the files with <code>gcloud storage cp ...</code>.</p>
<div class="section level3">
<h3 id="delete-resources">Delete resources<a class="anchor" aria-label="anchor" href="#delete-resources"></a>
</h3>
<p>Delete the workflow after each run so that the “pods” do not
accumulate. They are not running anymore but still visible.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">argo</span> delete <span class="at">-n</span> argo @latest</span></code></pre>
</div>
<p>Do not delete the cluster if you plan to continue to the <a href="06-scaleup">next section</a>, but do not keep it idle. The cost
goes by the time it exists, not by the time it is in use. You can always
create a new cluster.</p>
<p>You can delete all resources created by the Terraform script with</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="ex">terraform</span> destroy</span></code></pre>
</div>
<p>Confirm with “yes”.</p>
</div>
</section><section><h2 class="section-heading" id="costs">Costs<a class="anchor" aria-label="anchor" href="#costs"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="cluster">Cluster<a class="anchor" aria-label="anchor" href="#cluster"></a>
</h3>
<p>Running the workflow in the cluster does not increase the cost, so
for this small test, the estimates in the <a href="04-cluster#costs">previous section</a> are valid.</p>
</div>
<div class="section level3">
<h3 id="data-download">Data download<a class="anchor" aria-label="anchor" href="#data-download"></a>
</h3>
<p>As detailed in <a href="02-storage#networking-and-download">Section
02</a>, downloading data from the storage costs $0.12 / GB. The output
file size - and consequently the download cost - for this quick example
is small.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Once the cluster is up, you will first deploy the Argo Workflows
services using <code>kubectl</code>.</li>
<li>You will submit and monitor the workflow with
<code>argo</code>.</li>
<li>You can see the output in the bucket with <code>gcloud</code>
commands or on Google Cloud Console Web UI.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-06-scaleup"><p>Content from <a href="06-scaleup.html">Scale up</a></p>
<hr>
<p>Last updated on 2024-10-21 |

        <a href="https://github.com/cms-opendata-workshop/tutorial-lesson-cloud-processing-gcp/edit/main/episodes/06-scaleup.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 15 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How to process a full dataset?</li>
<li>What is an optimal cluster setup?</li>
<li>What is an optimal job configuration?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Optimize the cluster setup for a full dataset processing.</li>
<li>Learn about job configuration.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="resource-needs">Resource needs<a class="anchor" aria-label="anchor" href="#resource-needs"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="create-a-small-cluster-and-connect">Create a small cluster and connect<a class="anchor" aria-label="anchor" href="#create-a-small-cluster-and-connect"></a>
</h3>
<p>If you do not have the cluster from the previous sections, create a
new one. Set the number of nodes <code>gke_num_nodes</code> to 2 in the
<code>terraform.tfvars</code> file and create the resources, run</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">terraform</span> apply</span></code></pre>
</div>
<p>and confirm “yes”.</p>
<p>Connect to it with</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">gcloud</span> container clusters get-credentials <span class="op">&lt;</span>CLUSTER_NAME<span class="op">&gt;</span> --region europe-west4-a <span class="at">--project</span> <span class="op">&lt;</span>PROJECT_ID<span class="op">&gt;</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="run-a-test-job">Run a test job<a class="anchor" aria-label="anchor" href="#run-a-test-job"></a>
</h3>
<p>Run a small test as in the previous section, but set the number of
step to one. While the job is running, observe the resources usage
with</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">kubectl</span> get pods</span></code></pre>
</div>
<p>The big processing step - with <code>runpfnano</code> in the name -
defines the resource needs. The output indicates how much CPU (in units
of 1/1000 of a CPU) and memory the process consumes. Follow the resource
consumption during the job to see how it evolves.</p>
<p>The job configuration, i.e. how many jobs will be submitted in a
node, is defined by the resouce requests in the workflow definition.</p>
<p>In this example, we have defined them as</p>
<pre><code><span>      <span class="va">resources</span><span class="op">:</span></span>
<span>        <span class="va">requests</span><span class="op">:</span></span>
<span>          <span class="va">cpu</span><span class="op">:</span> <span class="st">"780m"</span></span>
<span>          <span class="va">memory</span><span class="op">:</span> <span class="st">"1.8Gi"</span></span>
<span>          <span class="va">ephemeral</span><span class="op">-</span><span class="va">storage</span><span class="op">:</span> <span class="st">"5Gi"</span>  </span></code></pre>
<p>and the main constraint here is the CPU. This request will guarantee
that only 1 jobs will run on a CPU.</p>
</div>
<div class="section level3">
<h3 id="delete-the-cluster">Delete the cluster<a class="anchor" aria-label="anchor" href="#delete-the-cluster"></a>
</h3>
<p>Once you have understood the resource consumption for a single job,
delete the cluster with <code>terraform destroy</code>.</p>
</div>
</section><section><h2 class="section-heading" id="cluster-configuration">Cluster configuration<a class="anchor" aria-label="anchor" href="#cluster-configuration"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="input-data">Input data<a class="anchor" aria-label="anchor" href="#input-data"></a>
</h3>
<p>The optimal cluster configuration depends on the input dataset.
Datasets consist of files, and the number of files can vary. In
practical terms, the input to the parallel processing steps is a list of
files. Dividing events from input files to different processing steps
can be done, but would require a filtering list as an input to the
processing.</p>
<p>In an ideal case, the parallel steps should take the same amount of
time to complete. However, this is usually not the case because</p>
<ul>
<li>input files are not equal in size</li>
<li>processing time per events can vary.</li>
</ul>
<p>However, the best approach is to have the same amount of files in
each parallel step. Eventually, the files could be sorted according to
their size and their share to the nodes could be optimized.</p>
<p>In the example case, we have used the <a href="https://opendata.cern.ch/record/30511" class="external-link">MuonEG MiniAOD dataset</a>
with 353 input files. For that number of files, we deployed a cluster
with 90 nodes 4-vCPU nodes, providing a total of 360 vCPUs. We can
therefore define a workflow with 353 parallel jobs and have a close to
full occupation of the cluster.</p>
<p>The relevant Terraform input variables fur such cluster are</p>
<pre><code><span><span class="va">project_id</span>          <span class="op">=</span> <span class="st">"&lt;PROJECT_ID&gt;"</span></span>
<span><span class="va">region</span>              <span class="op">=</span> <span class="st">"europe-west4"</span></span>
<span><span class="va">gke_num_nodes</span>       <span class="op">=</span> <span class="fl">30</span></span></code></pre>
<p>Note that as the “zone” (a, b or c in the location name) is not
defined, the cluster will have 30 nodes in each zone, in total 90.</p>
<p>Alternatively, a smaller cluster would be less expensive per unit
time but the processing takes a longer. In the benchmarking, a large
cluster was found to be practical.</p>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">
  <div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>
  Insufficient quota?
  </h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler1" aria-labelledby="headingSpoiler1">
<div class="accordion-body">
<p>GCP sets quotas to resources, and you can either increase them - to a
certain limit - or request a quota increase.</p>
<p>You will notice when you go beyond the predefined quota from this
type of message during the cluster creation:</p>
<pre><code>[...]
Error: error creating NodePool: googleapi: Error 403:
Error waiting for creating GKE cluster: Insufficient quota to satisfy the request:</code></pre>
<p>If that happens, go to the <a href="https://console.cloud.google.com/iam-admin/quotas" class="external-link">Quotas &amp;
System Limits page</a> at the Google Cloud Console. The link is also in
the error message. Search for quotas that you need to increase.</p>
<p>For a cluster with a big number of nodes, you must increase the
quotas for “CPUs” and “In-use regional external IPv4 addresses”.</p>
<p>Once you find the quota line, click on the three vertical dots and
choose “Edit quota”.</p>
<p>If you can’t increase them to desired value, submit a quota increase
request through this form. You will receive an email with increase
request approved (or rarely denied if the location is down in
resources). It is usually immediate, but takes some minutes to
propagate.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="autoscaling">Autoscaling<a class="anchor" aria-label="anchor" href="#autoscaling"></a>
</h3>
</div>
</section><section><h2 class="section-heading" id="costs">Costs<a class="anchor" aria-label="anchor" href="#costs"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="cluster-management-fee">Cluster management fee<a class="anchor" aria-label="anchor" href="#cluster-management-fee"></a>
</h3>
<p>For the GKE “Standard” cluster, there’s a cluster management fee of
$0.10 per hour.</p>
</div>
<div class="section level3">
<h3 id="cpu-and-memory">CPU and memory<a class="anchor" aria-label="anchor" href="#cpu-and-memory"></a>
</h3>
<p>The cost is determined by the machine and disk type and is per
time.</p>
<p>The cluster usage contributes to the cost through data transfer and
networking, but for this example case it is minimal.</p>
</div>
<div class="section level3">
<h3 id="data-download">Data download<a class="anchor" aria-label="anchor" href="#data-download"></a>
</h3>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>…</li>
<li>…</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/cms-opendata-workshop/tutorial-lesson-cloud-processing-gcp/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/cms-opendata-workshop/tutorial-lesson-cloud-processing-gcp/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/cms-opendata-workshop/tutorial-lesson-cloud-processing-gcp/" class="external-link">Source</a></p>
				<p><a href="https://github.com/cms-opendata-workshop/tutorial-lesson-cloud-processing-gcp/blob/main/CITATION.cff" class="external-link">Cite</a> | <a href="mailto:cms-dpoa-coordinator@cern.ch">Contact</a> | <a href="https://opendata.cern.ch/docs/about-cms" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.9" class="external-link">sandpaper (0.16.9)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.6" class="external-link">pegboard (0.7.6)</a>, and <a href="https://github.com/cms-opendata-workshop/varnish/tree/405b7a74ee1b2fc89c3e49e116ce96d4d65182b3" class="external-link">varnish (1.0.3)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://cms-opendata-workshop.github.io/tutorial-lesson-cloud-processing-gcp/instructor/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, CMS",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://cms-opendata-workshop.github.io/tutorial-lesson-cloud-processing-gcp/instructor/aio.html",
  "identifier": "https://cms-opendata-workshop.github.io/tutorial-lesson-cloud-processing-gcp/instructor/aio.html",
  "dateCreated": "2024-10-10",
  "dateModified": "2024-10-21",
  "datePublished": "2024-10-21"
}

  </script><script>
		feather.replace();
	</script>
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

